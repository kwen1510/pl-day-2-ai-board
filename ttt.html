<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Dilemma Tic Tac Toe v7 (Unbeatable AI)</title>
<style>
  body {font-family: Arial, sans-serif; background: #f5f5f5; margin: 0; padding: 20px; text-align: center;}
  .container {max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 0 10px rgba(0,0,0,0.1); position: relative;}
  .grid {display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 20px;}
  .box {background: #e0e0e0; padding: 40px 10px; border-radius: 8px; font-weight: bold; cursor: pointer; transition: background 0.3s;}
  .box:hover {background: #d5d5d5;}
  .player {background: #FFEB3B !important; color: #000;}
  .computer {background: #2196F3 !important; color: #fff;}
  .results {margin-top: 20px;}
  .description, .guideline {margin-top: 15px; background: #f0f0f0; padding: 10px; border-radius: 8px;}
  .heading {font-weight: bold; color: #1E88E5; font-size: 18px; margin-bottom: 10px;}
  .guideline strong {color: #6A1B9A;}
  button {padding: 10px 20px; margin: 10px; border: none; border-radius: 8px; cursor: pointer; font-size: 16px;}
  .yes {background: #4CAF50; color: white;}
  .no {background: #F44336; color: white;}
  .restart {background: #2196F3; color: white;}
  .clear-icon {position: absolute; top: 15px; right: 15px; width: 16px; height: 16px; background: #9C27B0; border-radius: 50%; cursor: pointer;}
</style>
</head>
<body>
<div class="container">
  <div class="clear-icon" onclick="promptClear()" title="Clear Data"></div>
  <h1>AI Dilemma Tic Tac Toe</h1>
  <div id="grid" class="grid"></div>
  <div id="scenario"></div>
  <div id="message" class="results"></div>
  <button class="restart" onclick="restartGame()">Restart Game</button>
</div>

<script>
const scenarios = [
  {h: "General Teaching Practice", q: "Students use ChatGPT to generate ideas for class discussion.", d: "Should I restrict AI use during class discussion?", g: "Lesson Enactment: Avoid over-reliance. Design parts of the lesson where students engage in non-AI critical thinking, discussion, or hands-on work."},
  {h: "General Teaching Practice", q: "Iâ€™m setting a take-home essay task and worry students may use AI to write it.", d: "Should I redesign the assignment to limit AI use?", g: "Assessment and Feedback: For weighted assessments, ensure tasks are (re)designed to test understanding beyond what AI can easily produce (e.g. oral presentations, process logs)."},
  {h: "General Teaching Practice", q: "I receive a piece of work that seems AI-generated, but Iâ€™m not certain.", d: "Should I confront the student directly about it?", g: "Assessment and Feedback: State clearly if AI is permitted in formative work, and the conditions (e.g. must acknowledge tool used, context of use)."},
  {h: "General Teaching Practice", q: "A teacher uses AI to draft Prelim/Promo exam questions.", d: "Should teachers rely on AI tools to generate assessment questions?", g: "Lesson Preparation: Select vetted, MOE-approved or school-endorsed AI tools (eg. SLS); avoid entering sensitive student or staff data into public tools (eg. ChatGPT, Gemini)."},
  {h: "Aesthetics / Creative Work", q: "A student submits a beautiful artwork fully generated by AI for an art project.", d: "Should AI-generated art be accepted as original student work?", g: "Positive Classroom Culture: Address misconceptions. Clarify that AI is a tool, not a replacement for human effort or creativity."},
  {h: "Humanities / GP", q: "Students use AI to paraphrase or â€œimproveâ€ their essays, producing fluent but impersonal writing.", d: "Should I allow students to use AI for editing and paraphrasing their essays?", g: "Assessment and Feedback: Encourage student reflection. If they use AI, have them explain how they applied, modified, or fact-checked its output."},
  {h: "Science & Math", q: "Students use ChatGPT to generate step-by-step solutions for tutorial questions.", d: "Should I allow students to use AI-generated solutions as part of their learning process?", g: "Positive Classroom Culture: Address misconceptions. Clarify that AI is a tool, not a replacement for human effort or creativity."},
  {h: "General Classroom Dynamics", q: "Students stop asking questions in class and instead use ChatGPT to find answers.", d: "Should I intervene when students replace teacher interaction with AI help?", g: "Lesson Enactment: Keep human facilitation central and be ready to evaluate and override AI output, teacher moderation ensures accuracy and relevance."},
  {h: "General Classroom Dynamics", q: "In a group project, some students rely heavily on ChatGPT while others work manually.", d: "Should AI-assisted contributions be assessed differently in group work?", g: "Assessment and Feedback: State clearly if AI is permitted in formative work, and the conditions (e.g. must acknowledge tool used, context of use)."}
];

let board = Array(9).fill(null);
let playerTurn = true;
let yesCounts = JSON.parse(localStorage.getItem('yesCounts_ttt_v7')) || Array(9).fill(0);
let noCounts = JSON.parse(localStorage.getItem('noCounts_ttt_v7')) || Array(9).fill(0);

const grid = document.getElementById('grid');
const scenarioDiv = document.getElementById('scenario');
const messageDiv = document.getElementById('message');

function saveData() {
  localStorage.setItem('yesCounts_ttt_v7', JSON.stringify(yesCounts));
  localStorage.setItem('noCounts_ttt_v7', JSON.stringify(noCounts));
}

function renderBoard() {
  grid.innerHTML = '';
  board.forEach((cell, i) => {
    const div = document.createElement('div');
    div.classList.add('box');
    div.textContent = scenarios[i].h;
    if (cell === 'player') div.classList.add('player');
    else if (cell === 'computer') div.classList.add('computer');
    if (playerTurn && !cell) div.onclick = () => handlePlayerMove(i);
    grid.appendChild(div);
  });
}

function handlePlayerMove(index) {
  if (!playerTurn || board[index]) return;
  scenarioDiv.innerHTML = '';
  board[index] = 'player';
  renderBoard();
  showScenario(index);
}

function showScenario(index) {
  const s = scenarios[index];
  scenarioDiv.innerHTML = `
    <div class='heading'>${s.h}</div>
    <p>${s.q}<br>ðŸ‘‰ ${s.d}</p>
    <button class='yes' onclick='recordVote(${index}, true)'>Yes</button>
    <button class='no' onclick='recordVote(${index}, false)'>No</button>
    <div class='guideline'><strong>Guideline:</strong> ${s.g}</div>
  `;
  playerTurn = false;
}

function recordVote(index, choice) {
  if (choice) yesCounts[index]++; else noCounts[index]++;
  saveData();

  const total = yesCounts[index] + noCounts[index];
  const yesPercent = ((yesCounts[index]/total)*100).toFixed(1);
  const noPercent = ((noCounts[index]/total)*100).toFixed(1);

  const s = scenarios[index];
  scenarioDiv.innerHTML = `
    <div class='heading'>${s.h}</div>
    <p>${s.q}<br>ðŸ‘‰ ${s.d}</p>
    <div class='results'><strong>Poll Results:</strong><br>
    ${yesCounts[index]} out of ${total} chose YES (${yesPercent}%)<br>
    ${noCounts[index]} out of ${total} chose NO (${noPercent}%)</div>
    <div class='guideline'><strong>Guideline:</strong> ${s.g}</div>
  `;

  setTimeout(() => {
    if (checkWinner('player')) {
      messageDiv.textContent = 'You win! ðŸŽ‰';
      disableBoard();
      return;
    }
    computerMove();
  }, 2000);
}

function computerMove() {
  const bestMove = findBestMove(board);
  if (bestMove !== -1) {
    board[bestMove] = 'computer';
    renderBoard();
  }
  if (checkWinner('computer')) {
    messageDiv.textContent = 'Computer wins! ðŸ’»';
    disableBoard();
    return;
  }
  if (!board.includes(null)) {
    messageDiv.textContent = 'Itâ€™s a draw!';
    return;
  }
  messageDiv.textContent = 'Your turn!';
  playerTurn = true;
  renderBoard();
}

function checkWinner(player) {
  const wins = [
    [0,1,2], [3,4,5], [6,7,8],
    [0,3,6], [1,4,7], [2,5,8],
    [0,4,8], [2,4,6]
  ];
  return wins.some(combo => combo.every(i => board[i] === player));
}

// --- Minimax Algorithm for Perfect Play ---
function minimax(newBoard, depth, isMaximizing) {
  if (checkWinner('computer')) return 10 - depth;
  if (checkWinner('player')) return depth - 10;
  if (!newBoard.includes(null)) return 0;

  if (isMaximizing) {
    let bestScore = -Infinity;
    for (let i = 0; i < 9; i++) {
      if (newBoard[i] === null) {
        newBoard[i] = 'computer';
        let score = minimax(newBoard, depth + 1, false);
        newBoard[i] = null;
        bestScore = Math.max(score, bestScore);
      }
    }
    return bestScore;
  } else {
    let bestScore = Infinity;
    for (let i = 0; i < 9; i++) {
      if (newBoard[i] === null) {
        newBoard[i] = 'player';
        let score = minimax(newBoard, depth + 1, true);
        newBoard[i] = null;
        bestScore = Math.min(score, bestScore);
      }
    }
    return bestScore;
  }
}

function findBestMove(currentBoard) {
  let bestScore = -Infinity;
  let move = -1;
  for (let i = 0; i < 9; i++) {
    if (currentBoard[i] === null) {
      currentBoard[i] = 'computer';
      let score = minimax(currentBoard, 0, false);
      currentBoard[i] = null;
      if (score > bestScore) {
        bestScore = score;
        move = i;
      }
    }
  }
  return move;
}

function disableBoard() {
  grid.querySelectorAll('.box').forEach(b => b.onclick = null);
}

function restartGame() {
  board = Array(9).fill(null);
  playerTurn = true;
  scenarioDiv.innerHTML = '';
  messageDiv.textContent = '';
  renderBoard();
}

function promptClear() {
  const pw = window.prompt('Enter password to clear data:');
  if (pw === 'PLD2') {
    localStorage.removeItem('yesCounts_ttt_v7');
    localStorage.removeItem('noCounts_ttt_v7');
    yesCounts = Array(9).fill(0);
    noCounts = Array(9).fill(0);
    alert('Data cleared successfully!');
    restartGame();
  } else if (pw !== null) {
    alert('Incorrect password.');
  }
}

renderBoard();
</script>
</body>
</html>
